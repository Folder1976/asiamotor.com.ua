<?php
 class ControllerExtensionModuleGroupPrice extends Controller{private $a59b2be388f1c11f32a240e7f60898971=array();public function index(){$aea253bc5f0b0ce5c474a9ac5ab78a5d3=$this->load->language('extension/module/group_price');$this->document->setTitle($this->language->get('heading_title'));$this->load->model('catalog/group_price');$this->load->model('setting/setting');if(($this->request->server['REQUEST_METHOD']=='POST')&&$this->validate()){$this->model_setting_setting->editSetting('group_price',$this->request->post);$this->model_catalog_group_price->saveCategoryPrices($this->request->post);$this->model_catalog_group_price->saveManufacturePrices($this->request->post);if(isset($this->error)&&is_array($this->error)){$this->error=array_merge($this->error,$this->model_catalog_group_price->getError());}else{$this->error=$this->model_catalog_group_price->getError();}$this->session->data['success']=$this->language->get('text_success');}$aea253bc5f0b0ce5c474a9ac5ab78a5d3['token']=$this->session->data['token'];if(isset($this->error)&&$this->error){$aea253bc5f0b0ce5c474a9ac5ab78a5d3['error_warning']=implode('<br />',$this->error);}else{$aea253bc5f0b0ce5c474a9ac5ab78a5d3['error_warning']='';}$aea253bc5f0b0ce5c474a9ac5ab78a5d3['breadcrumbs']=array();$aea253bc5f0b0ce5c474a9ac5ab78a5d3['breadcrumbs'][]=array('text'=>$this->language->get('text_home'),'href'=>$this->url->link('common/home','token='.$this->session->data['token'],'SSL'),'separator'=>false);$aea253bc5f0b0ce5c474a9ac5ab78a5d3['breadcrumbs'][]=array('text'=>$this->language->get('text_module'),'href'=>$this->url->link('extension/extension','token='.$this->session->data['token'],'SSL'),'separator'=>' :: ');$aea253bc5f0b0ce5c474a9ac5ab78a5d3['breadcrumbs'][]=array('text'=>$this->language->get('heading_title'),'href'=>$this->url->link('extension/module/group_price','token='.$this->session->data['token'],'SSL'),'separator'=>' :: ');$aea253bc5f0b0ce5c474a9ac5ab78a5d3['action']=$this->url->link('extension/module/group_price','token='.$this->session->data['token'],'SSL');$aea253bc5f0b0ce5c474a9ac5ab78a5d3['cancel']=$this->url->link('extension/extension','token='.$this->session->data['token'],'SSL');$this->load->model('customer/customer_group');$aea253bc5f0b0ce5c474a9ac5ab78a5d3['customer_groups']=$this->model_customer_customer_group->getCustomerGroups();$a89df8cb95efec2ce50f70b0ff0d60126=$this->model_catalog_group_price->getAllDbCategories();$aea253bc5f0b0ce5c474a9ac5ab78a5d3['categories']=array('0'=>array('category_id'=>0,'name'=>$this->language->get('group_base_price')));$aea253bc5f0b0ce5c474a9ac5ab78a5d3['categories']+=$this->model_catalog_group_price->getAllCategoriesWithParents($a89df8cb95efec2ce50f70b0ff0d60126);$aea253bc5f0b0ce5c474a9ac5ab78a5d3['categories_price']=$this->model_catalog_group_price->getAllCategoriesPrice();$this->load->model('catalog/manufacturer');$aea253bc5f0b0ce5c474a9ac5ab78a5d3['manufacturers']=$this->model_catalog_manufacturer->getManufacturers();$aea253bc5f0b0ce5c474a9ac5ab78a5d3['manufacturers_price']=$this->model_catalog_group_price->getAllManufacturersPrice();$aea253bc5f0b0ce5c474a9ac5ab78a5d3['currency']=$this->config->get('config_currency');if(isset($this->request->post['group_price_options'])){$aea253bc5f0b0ce5c474a9ac5ab78a5d3['options']=$this->request->post['group_price_options'];}elseif($this->config->get('group_price_options')){$aea253bc5f0b0ce5c474a9ac5ab78a5d3['options']=$this->config->get('group_price_options');}$aea253bc5f0b0ce5c474a9ac5ab78a5d3['header']=$this->load->controller('common/header');$aea253bc5f0b0ce5c474a9ac5ab78a5d3['column_left']=$this->load->controller('common/column_left');$aea253bc5f0b0ce5c474a9ac5ab78a5d3['footer']=$this->load->controller('common/footer');$this->response->setOutput($this->load->view('extension/module/group_price.tpl',$aea253bc5f0b0ce5c474a9ac5ab78a5d3));}public function install(){$this->load->model('catalog/group_price');$this->model_catalog_group_price->install();$this->load->model('setting/setting');$this->model_setting_setting->deleteSetting('group_price');$a795dd7b9262e461764bfe6be572be7cf=array('key'=>'7a783e7a121e1899dd9212b0e1bb83f2',);$a2f613c96fec7152d8cc2f3e2c66421d0['group_price_options']=$a795dd7b9262e461764bfe6be572be7cf;$this->model_setting_setting->editSetting('group_price',$a2f613c96fec7152d8cc2f3e2c66421d0);}public function uninstall(){$this->load->model('catalog/group_price');$this->model_catalog_group_price->uninstall();$this->load->model('setting/setting');$this->model_setting_setting->deleteSetting('group_price');}private function validate(){if(!$this->user->hasPermission('modify','extension/module/group_price')){$this->error['warning']=$this->language->get('error_permission');}return!$this->error?TRUE:FALSE;}public function updateDbPrice(){$ac45d9fc04a9bf4e8fc5ae5a11924d207=array();$this->load->language('extension/module/group_price');$this->load->model('catalog/group_price');if(!$this->validate()){$ac45d9fc04a9bf4e8fc5ae5a11924d207['error']=$this->language->get('error_permission');}else{$aa119fbf88cdf23c65e67cd04433e20a3=$this->model_catalog_group_price->updateDbPrice($this->request->get);if($aa119fbf88cdf23c65e67cd04433e20a3===FALSE){$ac45d9fc04a9bf4e8fc5ae5a11924d207['error']=$this->language->get('refresh_link_error');}else{$ac45d9fc04a9bf4e8fc5ae5a11924d207['success']=$this->language->get('refresh_link_success').$aa119fbf88cdf23c65e67cd04433e20a3;}}$this->response->setOutput(json_encode($ac45d9fc04a9bf4e8fc5ae5a11924d207));}}