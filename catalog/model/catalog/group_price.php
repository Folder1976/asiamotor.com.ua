<?php
 class ModelCatalogGroupPrice extends Model{private static $a3c042bff47b081b46ea015dd1c896955=array();private static $a1726b7736ccb5a3825f03114d55e9834=array();public function updatePrice($a826c81e06c09f9917fc8e3e7d0792c51,$aa13ea468d73b57c648a7d1c2f6ef013d){$a0c57bd083b88b7e5a679343ea5154442=$this->getMinPrice($a826c81e06c09f9917fc8e3e7d0792c51);if($a0c57bd083b88b7e5a679343ea5154442['type']==2){$aa13ea468d73b57c648a7d1c2f6ef013d=$aa13ea468d73b57c648a7d1c2f6ef013d+$a0c57bd083b88b7e5a679343ea5154442['price'];}else{$aa13ea468d73b57c648a7d1c2f6ef013d=$aa13ea468d73b57c648a7d1c2f6ef013d+$aa13ea468d73b57c648a7d1c2f6ef013d*$a0c57bd083b88b7e5a679343ea5154442['price']/100;}if($aa13ea468d73b57c648a7d1c2f6ef013d<0){$aa13ea468d73b57c648a7d1c2f6ef013d=0;}return $aa13ea468d73b57c648a7d1c2f6ef013d;}private function getMinPrice($a826c81e06c09f9917fc8e3e7d0792c51){$a31977096e1ad0938d522d2145593de1a=$a826c81e06c09f9917fc8e3e7d0792c51['product_id'];$a1e260602c1808f510df015eb8b5bef75=$a826c81e06c09f9917fc8e3e7d0792c51['manufacturer_id'];;$aa13ea468d73b57c648a7d1c2f6ef013d=array('price'=>0,'type'=>1);$a89df8cb95efec2ce50f70b0ff0d60126=array();$this->load->model('catalog/product');$a6c9290c22d576b3d9aef86e1583ff896=$this->model_catalog_product->getCategories($a31977096e1ad0938d522d2145593de1a);foreach($a6c9290c22d576b3d9aef86e1583ff896 as $ab3be4cc88d69e412ad0be9e47e14eeae){$a89df8cb95efec2ce50f70b0ff0d60126[]=$ab3be4cc88d69e412ad0be9e47e14eeae['category_id'];}$a58d3b28398a1052e8b0dda5800eb2072=$this->getCategoryMinPrice($a89df8cb95efec2ce50f70b0ff0d60126);if(!empty($a58d3b28398a1052e8b0dda5800eb2072)){$aa13ea468d73b57c648a7d1c2f6ef013d['category']=$a58d3b28398a1052e8b0dda5800eb2072;}$a245d1877a78d413d98f2f2936a2e6839=$this->getManufacturerMinPrice($a1e260602c1808f510df015eb8b5bef75);if(!empty($a245d1877a78d413d98f2f2936a2e6839)){$aa13ea468d73b57c648a7d1c2f6ef013d['manufacturer']=$a245d1877a78d413d98f2f2936a2e6839;}if(isset($aa13ea468d73b57c648a7d1c2f6ef013d['manufacturer'])&&isset($aa13ea468d73b57c648a7d1c2f6ef013d['category'])&&$aa13ea468d73b57c648a7d1c2f6ef013d['manufacturer']['type']==$aa13ea468d73b57c648a7d1c2f6ef013d['category']['type']){return($aa13ea468d73b57c648a7d1c2f6ef013d['manufacturer']['price']>$aa13ea468d73b57c648a7d1c2f6ef013d['category']['price'])?$aa13ea468d73b57c648a7d1c2f6ef013d['manufacturer']:$aa13ea468d73b57c648a7d1c2f6ef013d['category'];}elseif(isset($aa13ea468d73b57c648a7d1c2f6ef013d['manufacturer'])){return $aa13ea468d73b57c648a7d1c2f6ef013d['manufacturer'];}elseif(isset($aa13ea468d73b57c648a7d1c2f6ef013d['category'])){return $aa13ea468d73b57c648a7d1c2f6ef013d['category'];}return $aa13ea468d73b57c648a7d1c2f6ef013d;}private function getCategoryMinPrice($a89df8cb95efec2ce50f70b0ff0d60126){if(empty(self::$a3c042bff47b081b46ea015dd1c896955)){if($this->customer->isLogged()){$ae66e3a219894a6aa4861a23e026475fc=$this->customer->getGroupId();}else{$ae66e3a219894a6aa4861a23e026475fc=$this->config->get('config_customer_group_id');}$aa8daff5428ec98a4411850150c8bfc5c="SELECT price, type, category_id FROM ".DB_PREFIX."customer_group_price 
				WHERE customer_group_id = ".(int) $ae66e3a219894a6aa4861a23e026475fc;$aa8daff5428ec98a4411850150c8bfc5c=$this->db->query($aa8daff5428ec98a4411850150c8bfc5c);foreach($aa8daff5428ec98a4411850150c8bfc5c->rows as $ad0ed9c4d850517bca4f1bfed05aa4535){self::$a3c042bff47b081b46ea015dd1c896955[$ad0ed9c4d850517bca4f1bfed05aa4535['category_id']]=$ad0ed9c4d850517bca4f1bfed05aa4535;}}$a0c57bd083b88b7e5a679343ea5154442=NULL;foreach($a89df8cb95efec2ce50f70b0ff0d60126 as $a449b26504977ce1bef04e6bc5463fc60){if(isset(self::$a3c042bff47b081b46ea015dd1c896955[$a449b26504977ce1bef04e6bc5463fc60])){if($a0c57bd083b88b7e5a679343ea5154442==NULL){$a0c57bd083b88b7e5a679343ea5154442['price']=self::$a3c042bff47b081b46ea015dd1c896955[$a449b26504977ce1bef04e6bc5463fc60]['price'];$a0c57bd083b88b7e5a679343ea5154442['type']=self::$a3c042bff47b081b46ea015dd1c896955[$a449b26504977ce1bef04e6bc5463fc60]['type'];}else if(self::$a3c042bff47b081b46ea015dd1c896955[$a449b26504977ce1bef04e6bc5463fc60]['price']<$a0c57bd083b88b7e5a679343ea5154442['price']){$a0c57bd083b88b7e5a679343ea5154442['price']=self::$a3c042bff47b081b46ea015dd1c896955[$a449b26504977ce1bef04e6bc5463fc60]['price'];$a0c57bd083b88b7e5a679343ea5154442['type']=self::$a3c042bff47b081b46ea015dd1c896955[$a449b26504977ce1bef04e6bc5463fc60]['type'];}}}if($a0c57bd083b88b7e5a679343ea5154442==NULL&&isset(self::$a3c042bff47b081b46ea015dd1c896955[0])){$a0c57bd083b88b7e5a679343ea5154442['price']=self::$a3c042bff47b081b46ea015dd1c896955[0]['price'];$a0c57bd083b88b7e5a679343ea5154442['type']=self::$a3c042bff47b081b46ea015dd1c896955[0]['type'];}return $a0c57bd083b88b7e5a679343ea5154442;}private function getManufacturerMinPrice($a1e260602c1808f510df015eb8b5bef75){if(empty(self::$a1726b7736ccb5a3825f03114d55e9834)){if($this->customer->isLogged()){$ae66e3a219894a6aa4861a23e026475fc=$this->customer->getGroupId();}else{$ae66e3a219894a6aa4861a23e026475fc=$this->config->get('config_customer_group_id');}$aa8daff5428ec98a4411850150c8bfc5c="SELECT price, type, manufacturer_id FROM ".DB_PREFIX."manufacturer_group_price 
				WHERE customer_group_id = ".(int) $ae66e3a219894a6aa4861a23e026475fc;$aa8daff5428ec98a4411850150c8bfc5c=$this->db->query($aa8daff5428ec98a4411850150c8bfc5c);foreach($aa8daff5428ec98a4411850150c8bfc5c->rows as $ad0ed9c4d850517bca4f1bfed05aa4535){self::$a1726b7736ccb5a3825f03114d55e9834[$ad0ed9c4d850517bca4f1bfed05aa4535['manufacturer_id']]=$ad0ed9c4d850517bca4f1bfed05aa4535;}}$a0c57bd083b88b7e5a679343ea5154442=NULL;if(isset(self::$a1726b7736ccb5a3825f03114d55e9834[$a1e260602c1808f510df015eb8b5bef75])){$a0c57bd083b88b7e5a679343ea5154442['price']=self::$a1726b7736ccb5a3825f03114d55e9834[$a1e260602c1808f510df015eb8b5bef75]['price'];$a0c57bd083b88b7e5a679343ea5154442['type']=self::$a1726b7736ccb5a3825f03114d55e9834[$a1e260602c1808f510df015eb8b5bef75]['type'];}return $a0c57bd083b88b7e5a679343ea5154442;}}
//author sv2109 (sv2109@gmail.com) license for 1 product copy granted for ydimas (ydimas@gmail.com asiamotor.com.ua)
